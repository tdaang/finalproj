# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/finalproj/pyrate_mcmc_logs/mustelidae_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/finalproj/pyrate_mcmc_logs/mustelidae_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.326198775993, 0.326198775993,0.326198775993,0.326198775993,0.318869714784,0.312905435489,0.312905435489,0.318869714784,0.318869714784,0.318869714784,0.318869714784,0.312905435489,0.318869714784,0.318869714784,0.318869714784,0.312905435489,0.312905435489,0.318869714784,0.318869714784,0.318869714784,0.318869714784,0.318869714784,0.318869714784,0.320533489214,0.320533489214,0.320533489214,0.318869714784,0.318869714784,0.312905435489,0.312905435489,0.318869714784,0.318869714784,0.318869714784,0.318869714784,0.318869714784)
L_hpd_M95=c(0.454357607303, 0.454357607303,0.454357607303,0.454357607303,0.450936721267,0.44245800399,0.44245800399,0.450936721267,0.450936721267,0.450936721267,0.450936721267,0.44245800399,0.454357607303,0.454357607303,0.450936721267,0.470657838143,0.470657838143,0.485427552766,0.485427552766,0.485427552766,0.485427552766,0.485427552766,0.489074632141,0.494970336086,0.494970336086,0.494970336086,0.494970336086,0.497256469379,0.497256469379,0.527540429475,0.537178249512,0.537178249512,0.537178249512,0.537178249512,0.537178249512)
M_hpd_m95=c(0.246149746595, 0.246149746595,0.246149746595,0.246149746595,0.246149746595,0.246149746595,0.246149746595,0.246149746595,0.246149746595,0.246149746595,0.246149746595,0.246149746595,0.252616666202,0.252616666202,0.252616666202,0.252616666202,0.252616666202,0.252616666202,0.252616666202,0.252616666202,0.252616666202,0.252616666202,0.244089642957,0.244089642957,0.244089642957,0.246041643779,0.246041643779,0.246041643779,0.246041643779,0.244089642957,0.244089642957,0.244089642957,0.244089642957,0.241074451648,0.241074451648)
M_hpd_M95=c(0.349492303, 0.349492303,0.349492303,0.349492303,0.349492303,0.349492303,0.349492303,0.349492303,0.349492303,0.349492303,0.349492303,0.349492303,0.356770464425,0.355997136472,0.363793159739,0.363793159739,0.363793159739,0.363793159739,0.363793159739,0.363793159739,0.363793159739,0.363793159739,0.357732062634,0.357732062634,0.357732062634,0.357732062634,0.357732062634,0.357732062634,0.357732062634,0.357732062634,0.357732062634,0.357732062634,0.357732062634,0.357146108035,0.357146108035)
R_hpd_m95=c(-0.0136721051807, -0.0136721051807,-0.0136721051807,-0.0136721051807,3.7075404984e-05,3.7075404984e-05,0.00416110226653,3.7075404984e-05,3.7075404984e-05,3.7075404984e-05,3.7075404984e-05,0.00416110226653,0.00416110226653,-0.0204473980667,0.00416110226653,-0.0292529908662,-0.0292529908662,0.00416110226653,0.00416110226653,0.00416110226653,0.00445573680121,0.00445573680121,0.00416110226653,0.00416110226653,0.00416110226653,0.00416110226653,0.00416110226653,-0.0042030168698,-0.0136721051807,-0.0136721051807,-0.0179491504892,-0.0179491504892,-0.0179491504892,-0.060791552146,-0.060791552146)
R_hpd_M95=c(0.15840455703, 0.15840455703,0.15840455703,0.15840455703,0.161654567491,0.15840455703,0.16462476169,0.16462476169,0.16462476169,0.16462476169,0.16462476169,0.16462476169,0.1791928226,0.161654567491,0.1791928226,0.16462476169,0.176809543009,0.212079587006,0.212079587006,0.212079587006,0.212079587006,0.212079587006,0.212079587006,0.216797375206,0.216797375206,0.216797375206,0.219000171807,0.219000171807,0.212079587006,0.219000171807,0.219000171807,0.219000171807,0.219000171807,0.219000171807,0.219000171807)
L_mean=c(0.379440200531, 0.379440200531,0.379440200531,0.379371870002,0.377475022323,0.376869406716,0.376417331321,0.375937382538,0.37589019089,0.375938117236,0.375927171218,0.376367094863,0.377324407976,0.378113719142,0.379110870106,0.382927425,0.386842558353,0.389368486504,0.389456040691,0.389947501349,0.389981572701,0.389854713109,0.38908307767,0.390447523851,0.390345472249,0.390345472249,0.392646070115,0.394404917473,0.397597772386,0.398906267369,0.399970659542,0.399970659542,0.399970659542,0.399970659542,0.399970659542)
M_mean=c(0.296563270675, 0.296563270675,0.296563270675,0.296563270675,0.296503878881,0.296591503376,0.296591503376,0.296686044384,0.296663670969,0.296551155805,0.296551155805,0.296460012605,0.296895282935,0.29702362425,0.297575728106,0.297889758414,0.297889758414,0.297957305571,0.297957305571,0.297957305571,0.297818820641,0.297793231566,0.297689613042,0.297675178202,0.297706096916,0.297720058423,0.297657174357,0.297657174357,0.297657174357,0.298726280134,0.298726280134,0.298726280134,0.298726280134,0.299227417194,0.299227417194)
R_mean=c(0.0828769298556, 0.0828769298556,0.0828769298556,0.0828085993272,0.0809711434423,0.0802779033392,0.0798258279443,0.0792513381537,0.0792265199208,0.0793869614304,0.0793760154124,0.0799070822577,0.0804291250419,0.0810900948918,0.0815351419996,0.0850376665863,0.0889527999391,0.091411180933,0.0914987351204,0.0919901957785,0.0921627520598,0.0920614815431,0.0913934646282,0.0927723456489,0.0926393753332,0.0926254138265,0.0949888957574,0.0967477431163,0.0999405980289,0.100179987235,0.101244379408,0.101244379408,0.101244379408,0.100743242348,0.100743242348)
trans=0.5
age=(0:(35-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.590896074463), xlim = c(-36.75,1.75), ylab = 'Speciation rate', xlab = 'Ma',main='mustelidae' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 0.400172475713), xlim = c(-36.75,1.75), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.0668707073606, 0.240900188988), xlim = c(-36.75,1.75), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-36.75,1.75), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()